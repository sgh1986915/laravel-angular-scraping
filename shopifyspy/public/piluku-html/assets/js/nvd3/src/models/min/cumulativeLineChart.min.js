nv.models.cumulativeLineChart=function(){"use strict";function t(w){return w.each(function(w){function H(){d3.select(t.container).style("cursor","ew-resize")}function z(){M.x=d3.event.x,M.i=Math.round(Y.invert(M.x)),V()}function E(){d3.select(t.container).style("cursor","auto"),C.index=M.i,L.stateChange(C)}function V(){ne.data([M]);var e=t.transitionDuration();t.transitionDuration(0),t.update(),t.transitionDuration(e)}var G=d3.select(this).classed("nv-chart-"+D,!0),N=this,R=(p||parseInt(G.style("width"))||960)-c.left-c.right,X=(f||parseInt(G.style("height"))||400)-c.top-c.bottom;if(t.update=function(){G.transition().duration(W).call(t)},t.container=this,C.disabled=w.map(function(t){return!!t.disabled}),!S){var P;S={};for(P in C)S[P]=C[P]instanceof Array?C[P].slice(0):C[P]}var j=d3.behavior.drag().on("dragstart",H).on("drag",z).on("dragend",E);if(!(w&&w.length&&w.filter(function(t){return t.values.length}).length)){var B=G.selectAll(".nv-noData").data([A]);return B.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),B.attr("x",c.left+R/2).attr("y",c.top+X/2).text(function(t){return t}),t}if(G.selectAll(".nv-noData").remove(),n=i.xScale(),a=i.yScale(),k)i.yDomain(null);else{var T=w.filter(function(t){return!t.disabled}).map(function(t){var e=d3.extent(t.values,i.y());return e[0]<-.95&&(e[0]=-.95),[(e[0]-e[1])/(1+e[1]),(e[1]-e[0])/(1+e[0])]}),q=[d3.min(T,function(t){return t[0]}),d3.max(T,function(t){return t[1]})];i.yDomain(q)}Y.domain([0,w[0].values.length-1]).range([0,R]).clamp(!0);var w=e(M.i,w),J=b?"none":"all",K=G.selectAll("g.nv-wrap.nv-cumulativeLine").data([w]),O=K.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g"),Q=K.select("g");if(O.append("g").attr("class","nv-interactive"),O.append("g").attr("class","nv-x nv-axis").style("pointer-events","none"),O.append("g").attr("class","nv-y nv-axis"),O.append("g").attr("class","nv-background"),O.append("g").attr("class","nv-linesWrap").style("pointer-events",J),O.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none"),O.append("g").attr("class","nv-legendWrap"),O.append("g").attr("class","nv-controlsWrap"),g&&(l.width(R),Q.select(".nv-legendWrap").datum(w).call(l),c.top!=l.height()&&(c.top=l.height(),X=(f||parseInt(G.style("height"))||400)-c.top-c.bottom),Q.select(".nv-legendWrap").attr("transform","translate(0,"+-c.top+")")),y){var U=[{key:"Re-scale y-axis",disabled:!k}];s.width(140).color(["#444","#444","#444"]),Q.select(".nv-controlsWrap").datum(U).attr("transform","translate(0,"+-c.top+")").call(s)}K.attr("transform","translate("+c.left+","+c.top+")"),m&&Q.select(".nv-y.nv-axis").attr("transform","translate("+R+",0)");var Z=w.filter(function(t){return t.tempDisabled});K.select(".tempDisabled").remove(),Z.length&&K.append("text").attr("class","tempDisabled").attr("x",R/2).attr("y","-.71em").style("text-anchor","end").text(Z.map(function(t){return t.key}).join(", ")+" values cannot be calculated for this time period."),b&&(u.width(R).height(X).margin({left:c.left,top:c.top}).svgContainer(G).xScale(n),K.select(".nv-interactive").call(u)),O.select(".nv-background").append("rect"),Q.select(".nv-background rect").attr("width",R).attr("height",X),i.y(function(t){return t.display.y}).width(R).height(X).color(w.map(function(t,e){return t.color||d(t,e)}).filter(function(t,e){return!w[e].disabled&&!w[e].tempDisabled}));var $=Q.select(".nv-linesWrap").datum(w.filter(function(t){return!t.disabled&&!t.tempDisabled}));$.call(i),w.forEach(function(t,e){t.seriesIndex=e});var _=w.filter(function(t){return!t.disabled&&!!I(t)}),te=Q.select(".nv-avgLinesWrap").selectAll("line").data(_,function(t){return t.key}),ee=function(t){var e=a(I(t));return 0>e?0:e>X?X:e};te.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(t){return i.color()(t,t.seriesIndex)}).attr("x1",0).attr("x2",R).attr("y1",ee).attr("y2",ee),te.style("stroke-opacity",function(t){var e=a(I(t));return 0>e||e>X?0:1}).attr("x1",0).attr("x2",R).attr("y1",ee).attr("y2",ee),te.exit().remove();var ne=$.selectAll(".nv-indexLine").data([M]);ne.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",.5).style("pointer-events","all").call(j),ne.attr("transform",function(t){return"translate("+Y(t.i)+",0)"}).attr("height",X),v&&(r.scale(n).ticks(Math.min(w[0].values.length,R/70)).tickSize(-X,0),Q.select(".nv-x.nv-axis").attr("transform","translate(0,"+a.range()[0]+")"),d3.transition(Q.select(".nv-x.nv-axis")).call(r)),h&&(o.scale(a).ticks(X/36).tickSize(-R,0),d3.transition(Q.select(".nv-y.nv-axis")).call(o)),Q.select(".nv-background rect").on("click",function(){M.x=d3.mouse(this)[0],M.i=Math.round(Y.invert(M.x)),C.index=M.i,L.stateChange(C),V()}),i.dispatch.on("elementClick",function(t){M.i=t.pointIndex,M.x=Y(M.i),C.index=M.i,L.stateChange(C),V()}),s.dispatch.on("legendClick",function(e){e.disabled=!e.disabled,k=!e.disabled,C.rescaleY=k,L.stateChange(C),t.update()}),l.dispatch.on("stateChange",function(e){C.disabled=e.disabled,L.stateChange(C),t.update()}),u.dispatch.on("elementMousemove",function(e){i.clearHighlights();var n,a,l,s=[];w.filter(function(t,e){return t.seriesIndex=e,!t.disabled}).forEach(function(r,o){a=nv.interactiveBisect(r.values,e.pointXValue,t.x()),i.highlightPoint(o,a,!0);var u=r.values[a];"undefined"!=typeof u&&("undefined"==typeof n&&(n=u),"undefined"==typeof l&&(l=t.xScale()(t.x()(u,a))),s.push({key:r.key,value:t.y()(u,a),color:d(r,r.seriesIndex)}))});var p=r.tickFormat()(t.x()(n,a));u.tooltip.position({left:l+c.left,top:e.mouseY+c.top}).chartContainer(N.parentNode).enabled(x).valueFormatter(function(t){return o.tickFormat()(t)}).data({value:p,series:s})(),u.renderGuideLine(l)}),u.dispatch.on("elementMouseout",function(){L.tooltipHide(),i.clearHighlights()}),L.on("tooltipShow",function(t){x&&F(t,N.parentNode)}),L.on("changeState",function(e){"undefined"!=typeof e.disabled&&(w.forEach(function(t,n){t.disabled=e.disabled[n]}),C.disabled=e.disabled),"undefined"!=typeof e.index&&(M.i=e.index,M.x=Y(M.i),C.index=e.index,ne.data([M])),"undefined"!=typeof e.rescaleY&&(k=e.rescaleY),t.update()})}),t}function e(t,e){return e.map(function(e){if(!e.values)return e;var n=i.y()(e.values[t],t);return-.95>n?(e.tempDisabled=!0,e):(e.tempDisabled=!1,e.values=e.values.map(function(t,e){return t.display={y:(i.y()(t,e)-n)/(1+n)},t}),e)})}var n,a,i=nv.models.line(),r=nv.models.axis(),o=nv.models.axis(),l=nv.models.legend(),s=nv.models.legend(),u=nv.interactiveGuideline(),c={top:30,right:30,bottom:50,left:60},d=nv.utils.defaultColor(),p=null,f=null,g=!0,v=!0,h=!0,m=!1,x=!0,y=!0,b=!1,k=!0,w=function(t,e,n){return"<h3>"+t+"</h3>"+"<p>"+n+" at "+e+"</p>"},D=i.id(),C={index:0,rescaleY:k},S=null,A="No Data Available.",I=function(t){return t.average},L=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),W=250;r.orient("bottom").tickPadding(7),o.orient(m?"right":"left"),s.updateState(!1);var Y=d3.scale.linear(),M={i:0,x:0},F=function(e,n){var a=e.pos[0]+(n.offsetLeft||0),l=e.pos[1]+(n.offsetTop||0),s=r.tickFormat()(i.x()(e.point,e.pointIndex)),u=o.tickFormat()(i.y()(e.point,e.pointIndex)),c=w(e.series.key,s,u,e,t);nv.tooltip.show([a,l],c,null,null,n)};return i.dispatch.on("elementMouseover.tooltip",function(t){t.pos=[t.pos[0]+c.left,t.pos[1]+c.top],L.tooltipShow(t)}),i.dispatch.on("elementMouseout.tooltip",function(t){L.tooltipHide(t)}),L.on("tooltipHide",function(){x&&nv.tooltip.cleanup()}),t.dispatch=L,t.lines=i,t.legend=l,t.xAxis=r,t.yAxis=o,t.interactiveLayer=u,d3.rebind(t,i,"defined","isArea","x","y","xScale","yScale","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id"),t.options=nv.utils.optionsFunc.bind(t),t.margin=function(e){return arguments.length?(c.top="undefined"!=typeof e.top?e.top:c.top,c.right="undefined"!=typeof e.right?e.right:c.right,c.bottom="undefined"!=typeof e.bottom?e.bottom:c.bottom,c.left="undefined"!=typeof e.left?e.left:c.left,t):c},t.width=function(e){return arguments.length?(p=e,t):p},t.height=function(e){return arguments.length?(f=e,t):f},t.color=function(e){return arguments.length?(d=nv.utils.getColor(e),l.color(d),t):d},t.rescaleY=function(e){return arguments.length?(k=e,t):k},t.showControls=function(e){return arguments.length?(y=e,t):y},t.useInteractiveGuideline=function(e){return arguments.length?(b=e,e===!0&&(t.interactive(!1),t.useVoronoi(!1)),t):b},t.showLegend=function(e){return arguments.length?(g=e,t):g},t.showXAxis=function(e){return arguments.length?(v=e,t):v},t.showYAxis=function(e){return arguments.length?(h=e,t):h},t.rightAlignYAxis=function(e){return arguments.length?(m=e,o.orient(e?"right":"left"),t):m},t.tooltips=function(e){return arguments.length?(x=e,t):x},t.tooltipContent=function(e){return arguments.length?(w=e,t):w},t.state=function(e){return arguments.length?(C=e,t):C},t.defaultState=function(e){return arguments.length?(S=e,t):S},t.noData=function(e){return arguments.length?(A=e,t):A},t.average=function(e){return arguments.length?(I=e,t):I},t.transitionDuration=function(e){return arguments.length?(W=e,t):W},t};